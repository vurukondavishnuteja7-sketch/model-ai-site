<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model AI</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}

body{background:#0b1020;color:#fff}

/* LOGIN */
#loginPage{
display:flex;justify-content:center;align-items:center;
height:100vh;background:linear-gradient(135deg,#0f172a,#020617)
}

.login-box{
background:#111827;padding:35px;border-radius:14px;
width:280px;text-align:center;box-shadow:0 0 20px #000
}

.login-box h2{margin-bottom:15px}

.login-box button{
width:100%;padding:10px;margin-top:10px;border:none;
border-radius:8px;font-weight:bold;cursor:pointer
}

.google{background:#ef4444;color:#fff}
.email{background:#3b82f6;color:#fff}
.signup{background:#22c55e;color:#fff}

/* CHAT LAYOUT */
#chatPage{display:none;height:100vh}

.sidebar{
position:fixed;width:260px;height:100%;
background:#020617;padding:15px;border-right:1px solid #111
}

.sidebar h2{margin-bottom:15px}

.newchat{
background:#16a34a;color:#fff;border:none;
padding:10px;width:100%;border-radius:8px;margin-bottom:10px;
cursor:pointer
}

.logout{
background:#ef4444;border:none;padding:8px;
border-radius:6px;color:#fff;width:100%;cursor:pointer
}

.main{
margin-left:260px;height:100vh;
display:flex;flex-direction:column
}

/* HEADER */
.header{
padding:15px;border-bottom:1px solid #111;
font-weight:bold;background:#020617
}

/* MESSAGES */
.messages{
flex:1;overflow-y:auto;padding:20px;
display:flex;flex-direction:column;gap:12px
}

.msg{
padding:12px 16px;border-radius:12px;
max-width:70%;line-height:1.4;font-size:14px
}

.user{background:#16a34a;margin-left:auto}
.bot{background:#1f2937}

/* INPUT */
.input-box{
display:flex;padding:12px;border-top:1px solid #111;
background:#020617
}

.input-box input{
flex:1;padding:12px;border-radius:10px;border:none;
background:#111827;color:#fff
}

.send{
background:#16a34a;color:#fff;border:none;
padding:12px 18px;margin-left:10px;border-radius:10px;
cursor:pointer;font-weight:bold
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginPage">
  <div class="login-box">
    <h2>Login to Model AI</h2>
    <button class="google" onclick="googleLogin()">Google Login</button>
    <button class="email" onclick="emailLogin()">Email Login</button>
    <button class="signup" onclick="signup()">Sign Up</button>
  </div>
</div>

<!-- CHAT -->
<div id="chatPage">

  <div class="sidebar">
    <h2>Model AI</h2>
    <button class="newchat" onclick="clearChat()">+ New Chat</button>
    <button class="logout" onclick="logout()">Logout</button>
  </div>

  <div class="main">
    <div class="header">AI Assistant</div>

    <div id="messages" class="messages"></div>

    <div class="input-box">
      <input id="msgInput" placeholder="Send a message...">
      <button class="send" onclick="sendMsg()">Send</button>
    </div>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import {
getAuth, GoogleAuthProvider, signInWithPopup,
signInWithEmailAndPassword, createUserWithEmailAndPassword,
onAuthStateChanged, signOut
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
apiKey:"AIzaSyDUcWSbU-ELP7Erx9yGPbq65clsn2ME8pk",
authDomain:"model-ai-727b1.firebaseapp.com",
projectId:"model-ai-727b1",
storageBucket:"model-ai-727b1.firebasestorage.app",
messagingSenderId:"970799402645",
appId:"1:970799402645:web:4e2a93dbacbfd6ee97d59c"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

const loginPage = document.getElementById("loginPage");
const chatPage = document.getElementById("chatPage");
const messages = document.getElementById("messages");

/* AUTH STATE */
onAuthStateChanged(auth,user=>{
if(user){
loginPage.style.display="none";
chatPage.style.display="block";
}else{
loginPage.style.display="flex";
chatPage.style.display="none";
}
});

/* LOGIN METHODS */
window.googleLogin=()=>signInWithPopup(auth,provider).catch(e=>alert(e.message));

window.emailLogin=async()=>{
const email=prompt("Email:");
const pass=prompt("Password:");
await signInWithEmailAndPassword(auth,email,pass).catch(e=>alert(e.message));
};

window.signup=async()=>{
const email=prompt("Email:");
const pass=prompt("Password:");
await createUserWithEmailAndPassword(auth,email,pass).catch(e=>alert(e.message));
};

window.logout=()=>signOut(auth);

/* CHAT */
window.sendMsg=async()=>{
const input=document.getElementById("msgInput");
const text=input.value.trim();
if(!text)return;

addMsg(text,"user");
input.value="";

const res=await fetch("/api/chat",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({message:text})
});

const data=await res.json();
addMsg(data.reply || "No reply","bot");
};

function addMsg(text,type){
const div=document.createElement("div");
div.className="msg "+type;
div.innerText=text;
messages.appendChild(div);
messages.scrollTop=messages.scrollHeight;
}

window.clearChat=()=>messages.innerHTML="";
</script>

</body>
</html>
