<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model AI</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f9fafb;color:#000;display:flex;height:100vh}

.sidebar{width:220px;background:#fff;border-right:1px solid #e5e7eb;padding:15px}
.btn{padding:12px;border:none;border-radius:10px;font-weight:bold;cursor:pointer;width:100%;margin-bottom:10px}
.login{background:#10b981;color:#fff}
.logout{background:#ef4444;color:#fff}

.main{flex:1;display:flex;flex-direction:column}
.header{padding:15px;border-bottom:1px solid #e5e7eb;font-weight:bold}
.chat{flex:1;overflow:auto;padding:20px;display:flex;flex-direction:column;gap:12px}

.msg{max-width:70%;padding:12px;border-radius:12px}
.user{background:#2563eb;color:#fff;margin-left:auto}
.bot{background:#e5e7eb}

.input{display:flex;padding:10px;border-top:1px solid #e5e7eb;gap:8px;background:#fff}
input{flex:1;padding:12px;border-radius:10px;border:1px solid #ccc}
.send{background:#2563eb;color:#fff;border:none;padding:12px;border-radius:10px}
.icon{background:#e5e7eb;border:none;padding:10px;border-radius:10px}
</style>
</head>

<body>

<div class="sidebar">
<button class="btn login" onclick="login()">Login with Google</button>
<button class="btn logout" onclick="logout()">Logout</button>
<p id="user"></p>
</div>

<div class="main">
<div class="header">Model AI Assistant</div>
<div id="chat" class="chat"></div>

<div class="input">
<button class="icon" onclick="voice()">üé§</button>
<button class="icon" onclick="askImage()">üñºÔ∏è</button>
<input id="msg" placeholder="Type message...">
<button class="send" onclick="send()">Send</button>
</div>
</div>

<script>
/* FIREBASE CONFIG ‚Äî paste yours */
firebase.initializeApp({
  apiKey:"YOUR_KEY",
  authDomain:"YOUR_DOMAIN",
  projectId:"YOUR_ID"
});

const auth=firebase.auth();
const chat=document.getElementById("chat");

/* LOGIN */
function login(){
  auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
}
function logout(){ auth.signOut(); }

auth.onAuthStateChanged(u=>{
  document.getElementById("user").innerText = u ? u.email : "";
});

/* ADD MESSAGE */
function add(text,type,isImg=false){
  const el=document.createElement(isImg?"img":"div");
  if(isImg){ el.src=text; el.style.maxWidth="200px"; }
  else{ el.className="msg "+type; el.textContent=text; }
  chat.appendChild(el);
  chat.scrollTop=chat.scrollHeight;
}

/* SEND */
async function send(){
  const input=document.getElementById("msg");
  const text=input.value.trim();
  if(!text) return;

  add(text,"user");
  input.value="";

  const res=await fetch("/api/chat",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({message:text})
  });

  const data=await res.json();

  if(data.image){
    add(data.image,"bot",true);
  }else{
    add(data.reply,"bot");
    speak(data.reply);
  }
}

/* VOICE INPUT */
function voice(){
  const r=new(window.SpeechRecognition||window.webkitSpeechRecognition)();
  r.start();
  r.onresult=e=>msg.value=e.results[0][0].transcript;
}

/* VOICE REPLY */
function speak(t){
  speechSynthesis.speak(new SpeechSynthesisUtterance(t));
}

/* IMAGE PROMPT */
function askImage(){
  const p=prompt("Enter image description");
  if(p) msg.value="image: "+p;
}
</script>

</body>
</html>
